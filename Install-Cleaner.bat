@echo off
powershell -NoP -NonI -Command "Set-Location $ENV:TEMP; mkdir Clean-Install; Set-Location ./Clean-Install; $python = Read-Host "Install Python? (y/n)"; if ($python -eq 'y') { curl https://www.python.org/ftp/python/3.10.2/python-3.10.2-amd64.exe -o Python.exe; .\Python.exe; Write-Host "Python Installed."; }; $ssh = Read-Host "Install OpenSSH? (y/n)"; if ($ssh -eq 'y') { Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0;Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0; Start-Service sshd; Set-Service -Name sshd -StartupType 'Automatic'; if (!(Get-NetFirewallRule -Name "OpenSSH-Server-In-TCP" -ErrorAction SilentlyContinue | Select-Object Name, Enabled)) { New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22}; Get-WindowsCapability -Online | Where-Object Name -like 'OpenSSH*'; Write-Host "OpenSSH Installed."; }; $winrar = Read-Host "Install WinRAR? (y/n)"; if ($winrar -eq 'y') { curl https://www.win-rar.com/fileadmin/winrar-versions/winrar/winrar-x64-610.exe -o WinRAR.exe; .\WinRAR.exe; Write-Host "WinRAR Installed."; }; $debloat = Read-Host "Debloat Windows? (y/n)"; if ($debloat -eq 'y') { curl https://raw.githubusercontent.com/Sycnex/Windows10Debloater/master/Windows10Debloater.ps1 -o Debloater.ps1; Write-Host "Windows Debloated."; }; Write-Host "This script has now terminated."; $reboot = Read-Host "Restart computer? (y/n)"; if ($reboot -eq 'y') { shutdown -r -t 00 };"
